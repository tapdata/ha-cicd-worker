version: '3.8'

services:
  github-runner:
    build:
      context: ..
      dockerfile: docker/Dockerfile
    container_name: github-actions-runner
    environment:
      # 必需参数
      - RUNNER_TOKEN=${RUNNER_TOKEN}
      - RUNNER_REPO_URL=${RUNNER_REPO_URL}
      
      # 可选参数
      - RUNNER_NAME=${RUNNER_NAME:-docker-runner}
      - RUNNER_LABELS=${RUNNER_LABELS:-self-hosted,Linux,X64,docker}
      - RUNNER_WORK_DIR=${RUNNER_WORK_DIR:-_work}
    
    volumes:
      # 持久化工作目录
      - runner-work:/home/runner/_work
      
      # 如果需要访问 Docker（Docker-in-Docker）
      # - /var/run/docker.sock:/var/run/docker.sock
    
    restart: unless-stopped
    
    # 如果需要特权模式（用于 Docker-in-Docker）
    # privileged: true

volumes:
  runner-work:
    driver: local

